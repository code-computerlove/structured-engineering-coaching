# Object Oriented Programming Part 1

## Goals

- Understand the reason for the emergence of OOP as a paradigm.
- Understand limitations of inheritance within OOP and the alternative approaches.
- Identify the applications for OOP in building well architected solutions.
- Identify some common design patterns, why they exist, and how they have been incorporated into some languages as first-class concepts.

## Content

- A quick history lesson
- What OOP means to Code Computerlove
- Practical "OO" code vs OO code

## A quick history lesson

### In the beginning...

No code organisation. No management of complexity.

### Structured programming

The first paradigm.

- conditional statements

```csharp
if (widgets.Count >= 200) { ... }
```

- loops

```csharp
while (widget.Count >=) { ... }
```

- subroutines

```basic
GOSUB 370
```

### Modular programming

Managing complexity by separating code into modules, assemblies or classes.

### Abstract data types (ADT)

Managing complexity by type abstraction.

More than just data structures.

```fsharp
type PhoneNumber = {
  number: string
  extension: string option
}

type ContactDetail =
| Email of string
| Mobile of string
| Phone of PhoneNumber
```

### Alan Kay flavoured Object Oriented Programming (OOP)

Managing complexity by procedural abstraction.

Inspired by biological cells and the ADT model from Simula but implemented procedurally through techniques such as closures in Lisp rather than type definitions. Internal state was "closed over" and could not be reached from the outside making objects black boxes that could only be influenced by sending "messages" to.

Aimed to get rid of data structures.

> "OOP to me means only messaging"
>
> -- Alan Kay

Smalltalk was developed to support this idea of OOP as being about messages and black box architecture, and became the defacto language of enterprise development.

Sun originally tried to license Smalltalk so it would come by default on all Sun workstations. No Smalltalk vendor would agree to such a licensing model. So Sun developed Java instead.

### C++ flavoured OOP

Bjarne Stroustrup
C with classes (ADT-lite classes not OO classes)

C++ was a mixture of ADT-lite for namespacing and enough OOP buzzwords to ride the hype generated by Smalltalk. In many ways, C++ embodied the idea of OOP as a style of syntax.

> "I invented OOP and C++ was not what I had in mind."
>
> -- Alan Kay (hopefully apocryphal because it's incredibly arrogant)

Whilst Smalltalk was what big companies were using, the rise of affordable home computers and the fact that C++ was a free language meant there was now a large pool of untapped developers with C++ experience. Rebuffed by Smalltalk vendors, Sun developed Java and modelled it on C++ to take advantage of these devs.

Sun also put a lot of effort into Java supporting the newfangled Internet, something that Smalltalk vendors had not really payed any attention to.

Almost overnight, Java destroyed Smalltalk. This also had the unfortunate effect of making many people believe that OOP was the one true and only programming paradigm.

### Multi-paradigm

Whilst Alan Kay's pony may not have "won" the OO race, many developers have grown frustrated with the perceived shortcomings of OOP. This has led to a resurgence of interest in functional and procedural programming languages as well as lots of innovation in Java and C#.

In recognition that no paradigm is the best fit for all problems, most modern languages are now multi-paradigm, allowing procedural, functional and OO to a greater or lesser extent.

Many of C# 9's new features revolve around functional and procedural programming. E.G. Records and the ability to lose OO boilerplate for single class solutions.

## What OOP means to Code Computerlove

The truth of the matter is that C++ flavour languages are still so popular decades later because they are "good enough". They have demonstrated many times over that, in the hands of a mostly competent developer, a successful business can run on software developed in them.

However, there are also many examples in the industry of successful software products and the companies behind them disappearing without trace when the software was unable to adapt or deliver new features in a timely manner.

At Code we recognise that OOP is more than just syntax and that "OOP" languages do not automatically produce well architected, OO code. We also recognise that many of Alan Kay's ideas have remained popular in the agile and XP communities and we try to incorporate them into our own work.

## Practical - "OO" code vs OO code

### Objects are not a collection of properties

```csharp
public class PetrolTank
{
  public float MaxFuelInGallons { get; }
  public float CurrentFuelInGallons { get; private set; }

  public PetrolTank(float maxFuelInGallons, float currentFuelInGallons)
  {
    MaxFuelInGallons = maxFuelInGallons;
    CurrentFuelInGallons = currentFuelInGallons;
  }
}
```

```csharp
public class PetrolTank
{
  private float _maxFuelInGallons;
  private float _currentFuelInGallons;

  public PetrolTank(float maxFuelInGallons, float currentFuelInGallons)
  {
    _maxFuelInGallons = maxFuelInGallons;
    _currentFuelInGallons = currentFuelInGallons;
  }

  public float CurrentLevel => _currentFuelInGallons / _maxFuelInGallons * 100.0;
}
```

### Bad analogies

Car has 4 wheels. Leads to trying to simulate the real world.

```csharp
abstract class Vehicle, IReadOnly<Wheel>
{
    abstract void Start();
    abstract void Stop();
    float Speed { get; }
    IEnumerable<float> GetTyrePressures();
}

class Car : Vehicle
{
    /* ... */
}

class Bike : Vehicle
{
    /* ... */
}

class Cart : Vehicle
{
    // todo: tyre pressures?
}

class Tank : Vehicle
{
    // todo: tyre pressures?
}
```

Square is a type of rectangle?

Shape in general

```csharp
abstract class Shape { }

class Polygon : Shape { }

class Circle : Shape { }

class Triangle : Shape { }

class Rectangle : Shape { }

class Square : Shape { }
// or is Square a special case of Rectangle?
class Square : Rectangle { }
```

### It’s not taxonomy

Inheritance is overrated. Received wisdom that inheritance is the secret sauce of OO and EVERYTHING should use it everywhere possible.

sparrow is a type of bird is a type of animal is a type of lifeform is a type of object.

### It’s not mixins

ISaveable

```csharp
interface IFly
{
    public void Fly() => Console.WriteLine("I am flying");
}

interface ISwim
{
    public void Swim() => Console.WrlteLine("I am swimming");
}

interface IDive
{
    public void Dive() => Console.WriteLine("I am diving");
}

interface IEatBread
{
    public void EatBread() => Console.WriteLine("Yum.");
}

class Duck : IFly, ISwim, IDive, IEatBread { }

class AirbusA380 : IFly { }

class Submarine : IDive { }

class Person : ISwim, IDive, IEatBread { }
// unless they can't swim
// unless they're coeliac
```

### The DB model is not your domain model

Fossilised data as opposed to rich objects. No behaviour in relational DBs.

```csharp

class User
{
    public string Name { get; set; }
    public virtual List<Role> Roles { get; set; }
    public string PasswordHash { get; set; }
    public int PasswordIterations { get; set; }
}

class Role
{
    public string Name { get; set; }
}

class PasswordHash
{
    bool Matches(string plainText){...}
}
```
